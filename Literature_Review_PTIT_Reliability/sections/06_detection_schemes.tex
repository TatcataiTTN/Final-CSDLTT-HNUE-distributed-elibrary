% ============================================================================
% CHAPTER 6: DETECTION SCHEMES AND MODULATION
% ============================================================================

\chapter{Detection Schemes and Modulation}
\label{chap:detection_schemes}

\begin{quote}
\textit{This chapter reviews detection techniques and modulation schemes for optical QKD, with emphasis on coherent detection methods and the dual-threshold approach proposed by PTIT researchers.}
\end{quote}

% ============================================================================
% SECTION 6.1: DETECTION PARADIGMS
% ============================================================================

\section{Detection Paradigms in QKD}
\label{sec:detection_paradigms}

\subsection{Single-Photon Detection}

Traditional DV-QKD relies on single-photon detectors:

\begin{table}[h]
\centering
\caption{Single-Photon Detector Technologies}
\label{tab:spd_technologies}
\begin{tabular}{lccc}
\toprule
\textbf{Technology} & \textbf{Wavelength} & \textbf{Efficiency} & \textbf{Dark Count} \\
\midrule
Si-APD & 850 nm & 50-70\% & $<$100 Hz \\
InGaAs APD & 1550 nm & 10-25\% & 1-10 kHz \\
SNSPD & Broadband & $>$90\% & $<$10 Hz \\
\bottomrule
\end{tabular}
\end{table}

\textbf{Micius Implementation:} Silicon APDs at 850 nm, providing good efficiency but limiting wavelength choice.

\subsection{Coherent Detection}

Coherent detection offers an alternative paradigm:

\begin{itemize}
    \item \textbf{Homodyne:} Measures single quadrature ($X$ or $P$)
    \item \textbf{Heterodyne:} Measures both quadratures simultaneously
\end{itemize}

\textbf{Advantages:}
\begin{itemize}
    \item Uses standard telecom photodiodes
    \item Works at 1550 nm (fiber-compatible)
    \item Higher sensitivity with local oscillator gain
    \item Compatible with existing coherent communication infrastructure
\end{itemize}

% ============================================================================
% SECTION 6.2: HETERODYNE DETECTION
% ============================================================================

\section{Heterodyne Detection for QKD}
\label{sec:heterodyne}

\subsection{Principle of Operation}

In heterodyne detection, the signal is mixed with a strong local oscillator (LO) at a slightly different frequency:

\begin{equation}
E_{total} = E_s e^{i\omega_s t + i\phi_s} + E_{LO} e^{i\omega_{LO} t}
\label{eq:heterodyne_field}
\end{equation}

The photocurrent contains the beat signal:

\begin{equation}
i(t) \propto 2\sqrt{P_s P_{LO}} \cos((\omega_s - \omega_{LO})t + \phi_s)
\label{eq:beat_signal}
\end{equation}

\subsection{SNR Enhancement}

The LO provides effective amplification:

\begin{equation}
\text{SNR}_{het} = \frac{2\Re^2 P_s P_{LO}}{2q\Re P_{LO} B + \sigma_{th}^2}
\label{eq:snr_heterodyne}
\end{equation}

For strong LO ($P_{LO} \gg P_s$), shot noise limited operation is achieved.

\subsection{Application to QKD}

Research on coherent detection for QKD includes:

\begin{itemize}
    \item \textbf{CV-QKD:} Standard detection method for continuous-variable protocols
    \item \textbf{Discrete-Modulated CV-QKD:} Enables security with QPSK/8PSK modulation
    \item \textbf{PTIT Approach:} Heterodyne detection with dual-threshold decision
\end{itemize}

% ============================================================================
% SECTION 6.3: DUAL-THRESHOLD DETECTION
% ============================================================================

\section{Dual-Threshold Detection}
\label{sec:dual_threshold}

\subsection{Trinh et al. (2018)}

Trinh et al. \cite{trinh2018dualthreshold_ptit} introduced dual-threshold detection for QKD over FSO:

\textbf{Key Innovation:} Instead of a single decision threshold, two thresholds define three decision regions:

\begin{equation}
\text{Decision} = \begin{cases}
0 & \text{if } i \geq d_0 \\
1 & \text{if } i \leq d_1 \\
X & \text{if } d_1 < i < d_0 \text{ (erasure)}
\end{cases}
\label{eq:dt_decision}
\end{equation}

\subsection{Threshold Configuration}

The thresholds are defined relative to the decision point $d$:

\begin{align}
d_0 &= d + \varsigma \cdot \sigma \label{eq:d0}\\
d_1 &= d - \varsigma \cdot \sigma \label{eq:d1}
\end{align}

where $\varsigma$ is the dual-threshold coefficient and $\sigma$ is the noise standard deviation.

\subsection{Trade-off Analysis}

\begin{table}[h]
\centering
\caption{DT Coefficient Trade-offs}
\label{tab:dt_tradeoffs}
\begin{tabular}{lcc}
\toprule
\textbf{$\varsigma$ Value} & \textbf{QBER} & \textbf{$P_{sift}$} \\
\midrule
Small ($<$0.5) & Higher & Higher \\
Optimal (0.7--2.8) & Low & Acceptable \\
Large ($>$3.0) & Very low & Very low \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Evolution: DT/DD to DT/HD}

\begin{table}[h]
\centering
\caption{Detection Scheme Evolution at PTIT}
\label{tab:ptit_evolution}
\begin{tabular}{lccc}
\toprule
\textbf{Paper} & \textbf{Year} & \textbf{Detection} & \textbf{Improvement} \\
\midrule
Trinh et al. & 2018 & DT/DD & Baseline \\
Nguyen et al. & 2021 & DT/HD & +20 dB sensitivity \\
Nguyen et al. & 2023 & DT/HD + CV-QKD & Extended to CV \\
\bottomrule
\end{tabular}
\end{table}

% ============================================================================
% SECTION 6.4: MODULATION SCHEMES
% ============================================================================

\section{Modulation Schemes for QKD}
\label{sec:modulation}

\subsection{Polarization Encoding}

Traditional BB84 uses polarization states:

\begin{itemize}
    \item Rectilinear: $\ket{H}$, $\ket{V}$
    \item Diagonal: $\ket{D}$, $\ket{A}$
\end{itemize}

\textbf{Advantages:} Direct mapping to BB84 states
\textbf{Challenges:} Polarization alignment, fiber birefringence

\subsection{Phase Encoding}

Phase-encoded QKD maps information to optical phase:

\begin{equation}
\ket{\psi} = \ket{\alpha e^{i\phi}}
\label{eq:phase_encoding}
\end{equation}

\textbf{QPSK for QKD:}
\begin{equation}
\phi \in \left\{ \frac{\pi}{4}, \frac{3\pi}{4}, \frac{5\pi}{4}, \frac{7\pi}{4} \right\}
\label{eq:qpsk_phases}
\end{equation}

\subsection{Higher-Order Modulation}

Research has explored higher-order modulation for QKD:

\begin{itemize}
    \item \textbf{8-PSK:} 3 bits per symbol, higher spectral efficiency
    \item \textbf{16-QAM:} 4 bits per symbol, requires amplitude discrimination
    \item \textbf{Gaussian:} Continuous modulation for CV-QKD
\end{itemize}

\subsection{QPSK vs. Gaussian}

\begin{table}[h]
\centering
\caption{QPSK vs. Gaussian Modulation for QKD}
\label{tab:qpsk_gaussian}
\begin{tabular}{lcc}
\toprule
\textbf{Aspect} & \textbf{QPSK (Nguyen)} & \textbf{Gaussian (CV-QKD)} \\
\midrule
Alphabet & 4 discrete & Continuous \\
Preparation & Digital & Analog \\
Security proof & Via BB84 & Dedicated CV proofs \\
Implementation & Simpler & More complex \\
Key rate & Moderate & Higher (short dist.) \\
\bottomrule
\end{tabular}
\end{table}

% ============================================================================
% SECTION 6.5: RECEIVER DESIGN
% ============================================================================

\section{Receiver Architecture}
\label{sec:receiver}

\subsection{Nguyen et al. Receiver Design}

The proposed DT/HD receiver consists of:

\begin{enumerate}
    \item \textbf{Optical Front-End:}
    \begin{itemize}
        \item 90Â° optical hybrid
        \item Local oscillator generation
        \item Balanced photodetector pair
    \end{itemize}

    \item \textbf{Electrical Processing:}
    \begin{itemize}
        \item Transimpedance amplifier
        \item Low-pass filter
        \item Dual-threshold comparator
    \end{itemize}

    \item \textbf{Decision Logic:}
    \begin{itemize}
        \item Three-level output (0, 1, X)
        \item Erasure handling
        \item Sifting coordination
    \end{itemize}
\end{enumerate}

\subsection{Noise Sources}

The receiver noise model includes:

\begin{equation}
\sigma_{total}^2 = \sigma_{shot}^2 + \sigma_{thermal}^2 + \sigma_{dark}^2
\label{eq:noise_model}
\end{equation}

\textbf{Shot Noise:}
\begin{equation}
\sigma_{shot}^2 = 2q(\Re P_{LO} + I_d)B \cdot \bar{g}^2 F
\label{eq:shot_noise}
\end{equation}

\textbf{Thermal Noise:}
\begin{equation}
\sigma_{thermal}^2 = \frac{4k_B T B}{R_L}
\label{eq:thermal_noise}
\end{equation}

% ============================================================================
% SECTION 6.6: QBER ANALYSIS
% ============================================================================

\section{QBER Analysis}
\label{sec:qber_analysis}

\subsection{Error Probability Derivation}

For heterodyne detection with QPSK, the bit error probability:

\begin{equation}
P_e = \int_0^\infty Q\left(\sqrt{\frac{2h \cdot \text{SNR}}{1 + h \cdot \text{SNR}}}\right) f_{h_t}(h) dh
\label{eq:pe_integral}
\end{equation}

where $Q(\cdot)$ is the Q-function.

\subsection{Conditional QBER}

Given successful sifting (non-erasure):

\begin{equation}
\text{QBER} = \frac{P_e}{P_{sift}}
\label{eq:conditional_qber}
\end{equation}

\subsection{Optimal DT Coefficient Ranges}

\begin{table}[h]
\centering
\caption{Optimal $\varsigma$ Ranges from Nguyen et al.}
\label{tab:optimal_varsigma}
\begin{tabular}{lcc}
\toprule
\textbf{Condition} & \textbf{$\varsigma$ Range} & \textbf{Criterion} \\
\midrule
Weak turbulence & 0.7 -- 2.4 & QBER $\leq 10^{-3}$, $P_{sift} \geq 10^{-2}$ \\
Strong turbulence & 1.4 -- 2.8 & QBER $\leq 10^{-3}$, $P_{sift} \geq 10^{-2}$ \\
\bottomrule
\end{tabular}
\end{table}

% ============================================================================
% SECTION 6.7: CHAPTER SUMMARY
% ============================================================================

\section{Chapter Summary}
\label{sec:ch6_summary}

This chapter reviewed detection and modulation techniques for QKD:

\begin{enumerate}
    \item \textbf{Detection Paradigms:} Single-photon vs. coherent detection trade-offs
    \item \textbf{Heterodyne Detection:} LO gain provides 20 dB sensitivity improvement
    \item \textbf{Dual-Threshold:} Erasure region reduces QBER at cost of $P_{sift}$
    \item \textbf{QPSK Modulation:} Maps BB84 structure to phase states
    \item \textbf{PTIT Contribution:} DT/HD combination novel for satellite QKD
\end{enumerate}

\textbf{Key Innovation:} Nguyen et al.'s DT/HD approach bridges DV and CV paradigms, offering practical implementation advantages while maintaining security based on BB84 structure.
